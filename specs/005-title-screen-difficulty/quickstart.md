# Quickstart: Title Screen with Difficulty Selection

**Feature**: 005-title-screen-difficulty
**Date**: 2026-02-20

## Prerequisites

- Deno (latest stable) installed
- Repository cloned, on branch `005-title-screen-difficulty`

## Development

```bash
# Install dependencies (none beyond Deno)
# Start dev server
deno task serve

# Run tests
deno task test

# Build for production
deno task build

# Format code
deno task fmt

# Lint code
deno task lint
```

## Architecture Overview

This feature adds a **difficulty selection title screen** before gameplay begins. The implementation touches these areas:

### New: `src/game/difficulty/`

A new domain module defining the three difficulty levels and their game configurations:

| File            | Purpose                                                                           |
| --------------- | --------------------------------------------------------------------------------- |
| `model.ts`      | `DifficultyLevel` enum, `DifficultyConfig` type, `getDifficultyConfig()` function |
| `mod.ts`        | Barrel re-exports                                                                 |
| `model_test.ts` | Tests for config mapping                                                          |

### Modified: `src/game/state/`

- `model.ts` — `GameState` gains a `difficulty` field
- `generator.ts` — `generateInitialState()` accepts optional `boardSize` parameter
- `generator_test.ts` — Tests for 9-card and 12-card board generation

### Modified: `src/game/main.ts`

- Screen state management: title screen ↔ game board
- Reads `data-difficulty` from clicked button, maps to `DifficultyLevel`
- Passes `DifficultyConfig` to `createDeck()` and `generateInitialState()`
- "Back to title" button handler: hides game, shows title, discards state

### Modified: `src/index.vto`

- Adds `#title-screen` container with game name and 3 difficulty buttons
- Wraps game board in `#game-screen` container (hidden by default)
- Adds `#back-to-title` button above the game board

### Modified: `src/style.css`

- Adds fade transition for screen switching

## Key Design Decisions

1. **Difficulty = DeckOptions + board size**: Easy/Normal fix number to one value (27-card deck, 3 attributes: shape, shading, color). Hard uses full deck (81 cards, 4 attributes). Board is 9 cards (Easy) or 12 cards (Normal/Hard).

2. **No changes to set validation**: `isValidSet()` always checks all 4 attributes. When number is fixed, the number check trivially passes.

3. **Title screen is static HTML**: Rendered on first paint via `index.vto`, not generated by JS. Meets FCP < 1s goal.

4. **Grid adapts to board size**: 9 cards → `grid-cols-3`; 12 cards → `grid-cols-3 sm:grid-cols-4`.

## File Dependency Order (for implementation)

```
1. src/game/difficulty/model.ts       (new, no deps)
2. src/game/difficulty/mod.ts         (new, re-exports model)
3. src/game/difficulty/model_test.ts  (new, tests model)
4. src/game/state/model.ts            (add difficulty field)
5. src/game/state/generator.ts        (parameterize boardSize)
6. src/game/state/generator_test.ts   (test boardSize variations)
7. src/index.vto                      (add title screen HTML)
8. src/style.css                      (add transition styles)
9. src/game/main.ts                   (wire everything together)
```
