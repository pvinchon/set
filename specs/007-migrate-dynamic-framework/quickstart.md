# Quickstart: Migrate to Dynamic Framework

**Feature**: 007-migrate-dynamic-framework
**Date**: 2026-02-24

## What This Feature Does

Replaces the Lume static site generator with SvelteKit as the application framework, and Deno with Node.js/npm as the sole runtime. The Set Card Game continues to work identically — same gameplay, same visuals, same PWA offline support — but gains a modern component model with Svelte 5, file-based routing, and hot module replacement for development.

## Project Foundation

The project is scaffolded with the Svelte CLI:

```bash
npx sv create \
  --template minimal \
  --types ts \
  --add prettier eslint vitest="usages:unit,component" tailwindcss="plugins:none" sveltekit-adapter="adapter:static" \
  --install npm \
  <target-directory>
```

This generates a complete SvelteKit project with all tooling pre-configured. The migration builds on top of this scaffold.

## After Migration

### Prerequisites

- **Node.js 22 LTS** (22.13.0+) — required by scaffold deps; `.npmrc` enforces `engine-strict=true`

### Development

```bash
# Install dependencies (first time / after package.json changes)
npm install

# Start dev server with HMR
npm run dev

# Run all tests (single run)
npm run test

# Run tests in watch mode
npm run test:unit

# Lint (Prettier check + ESLint)
npm run lint

# Format (Prettier write)
npm run format

# Type check
npm run check
```

The dev server starts at `http://localhost:5173` with automatic hot reload on file changes.

### Production Build

```bash
# Build for production
npm run build

# Preview production build locally
npm run preview
```

Output goes to `build/` — deployable to any static hosting service.

### Key Differences from Lume + Deno

| Before (Lume + Deno)            | After (SvelteKit + Node.js)                            |
| ------------------------------- | ------------------------------------------------------ |
| `deno task serve`               | `npm run dev`                                          |
| `deno task build`               | `npm run build`                                        |
| `deno task test`                | `npm run test`                                         |
| `deno lint`                     | `npm run lint` (Prettier + ESLint)                     |
| `deno fmt`                      | `npm run format` (Prettier)                            |
| Output: `_site/`                | Output: `build/`                                       |
| Full page reload                | Module-level HMR                                       |
| Vento templates                 | `src/app.html` + Svelte components                     |
| Custom screen router            | SvelteKit file-based routing                           |
| Manual DOM construction         | Svelte 5 reactive components (runes)                   |
| Custom PWA plugin               | `@vite-pwa/sveltekit`                                  |
| `_config.ts` + `deno.json`      | `svelte.config.js` + `vite.config.ts` + `package.json` |
| `Deno.test` + `jsr:@std/assert` | Vitest `test` + `expect`                               |
| No type config (Deno built-in)  | `tsconfig.json` (extends `.svelte-kit/tsconfig.json`)  |
| `src/style.css`                 | `src/routes/layout.css`                                |

### What the Scaffold Provides

These files are generated by `sv create` and need no or minimal changes:

- `eslint.config.js` — ESLint with TypeScript + Svelte + Prettier
- `.prettierrc` — Prettier with Svelte + TailwindCSS plugins
- `.prettierignore` — Ignores lock files and `/static/`
- `.npmrc` — `engine-strict=true`
- `.gitignore` — Node.js + SvelteKit ignores
- `tsconfig.json` — Extends `.svelte-kit/tsconfig.json`
- `src/app.d.ts` — SvelteKit type declarations
- `.vscode/settings.json` — TailwindCSS file association

### Project Structure Changes

**Removed** (Lume/Deno-specific):

- `_config.ts`, `deno.json`
- `src/pwa/` (entire directory)
- `src/index.vto`, `src/_includes/layout.vto`
- `src/screens/router.ts`, `src/screens/title/component.ts`, `src/screens/play/component.ts`
- `src/game/board/component.ts`, `src/game/card/renderer.ts`, `src/game/main.ts`
- `src/style.css` (merged into `src/routes/layout.css`)

**From Scaffold** (generated by `sv create`):

- `svelte.config.js`, `vite.config.ts`, `package.json`
- `eslint.config.js`, `.prettierrc`, `.prettierignore`, `.npmrc`
- `tsconfig.json`, `src/app.html`, `src/app.d.ts`
- `src/routes/+layout.svelte`, `src/routes/+page.svelte`, `src/routes/layout.css`

**Added on top of scaffold**:

- `src/routes/play/+page.svelte` — Play screen
- `src/lib/game/board/Board.svelte` — Board component
- `src/lib/game/card/Card.svelte` — Card component
- `src/service-worker.ts` — Service worker source

**Moved** (same content, new location):

- `src/game/**` → `src/lib/game/**` (SvelteKit `$lib` convention)
- `src/utils/**` → `src/lib/utils/**`
- Icon assets → `static/icons/`

**Migrated** (test harness change only):

- All `*_test.ts` files → `*.test.ts` (Vitest convention)
- `Deno.test()` → `test()` / `describe()` / `it()`
- `jsr:@std/assert` → `vitest` assertions (`expect`)

**Unchanged**:

- All game logic (card model, deck, set validation, state, selection, difficulty, attributes)
- All utility modules (cx, grid, random)
